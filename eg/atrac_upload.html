<!DOCTYPE html>
<html>
<head>
    <title>
        ATRAC Upload form
    </title>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" media="screen" rel="stylesheet" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
</head>
<body>
    <h1>ATRAC Image Metadata Upload Form</h1>
    <div class="content">
    <form class="form-horizontal">
        <div class="control-group">
        <label class="control-label" for="chapter">Chapter</label>
        <div class="controls"> <select name='chapter' id="chapter">
                <option value="">--select--</option>
        </select> </div>
        </div>
        <div class="control-group">
        <label class="control-label" for="figure">Figure</label>
        <div class="controls"> <select name='figure' id="figure"></select> </div>
        </div>
        <div class="control-group">
        <label class="control-label" for="image">Image</label>
        <div class="controls"> <select name='image' id="image"></select> </div>
        </div>
    </form>
    </div>
    <script type='text/javascript'>
    var tuba = 'http://localhost:3000';
    function populate_chapter() {
        $.ajax({
                type     : "GET",
                url      : tuba + '/chapter',
                dataType : 'json',
                headers  : { Accept : "application/json" },
                error    : function(e,z) { console.log('error',e,z); alert('error') },
                }
              ).success(function(results){
                  $.each(results, function(i,result){
                      result = JSON.parse(result);
                      $('#chapter').append(
                          '<option value="' + result.short_name + '">' + result.short_name + '</option>');
                  })
               });
    }
    $(document).ready(function() {
            $(function() {
                $.ajaxSetup({
                    error: function(jqXHR, exception) {
                        if (jqXHR.status === 0) {
                            alert('Not connect.\n Verify Network.');
                        } else if (jqXHR.status == 404) {
                            alert('Requested page not found. [404]');
                        } else if (jqXHR.status == 500) {
                            alert('Internal Server Error [500].');
                        } else if (exception === 'parsererror') {
                            alert('Requested JSON parse failed.');
                        } else if (exception === 'timeout') {
                            alert('Time out error.');
                        } else if (exception === 'abort') {
                            alert('Ajax request aborted.');
                        } else {
                            alert('Uncaught Error.\n' + jqXHR.responseText);
                        }
                    }
                });
            });
            populate_chapter();
    });
    </script>
</body>
</html>
